/* SHA f()-functions */
#define f1(x,y,z)	((x & y) | (~x & z))
#define f2(x,y,z)	(x ^ y ^ z)
#define f3(x,y,z)	((x & y) | (x & z) | (y & z))
#define f4(x,y,z)	(x ^ y ^ z)

/* SHA constants */
#define K1		0x5A827999 // pow(2,30)*sqrt(2)
#define K2		0x6ED9EBA1 // pow(2,30)*sqrt(3)
#define K3		0x8F1BBCDC // pow(2,30)*sqrt(5)
#define K4		0xCA62C1D6 // pow(2,30)*sqrt(10)

/* 32-bit rotate */
#define ROL32(x,n)	((x << n) | (x >> (32 - n)))

#define FUNC(n,i)										\
    temp = ROL32(a,5) + f##n(b,c,d) + e + W[i] + K##n;	\
    e = d;												\
	d = c;												\
	c = ROL32(b,30);									\
	b = a;												\
	a = temp

unsigned char PADDING[64] = {0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};